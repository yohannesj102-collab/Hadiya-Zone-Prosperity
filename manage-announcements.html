<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Announcements - Hadiya Zone Prosperity Office</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="admin-nav">
        <div class="nav-brand">
            <h2><i class="fas fa-bullhorn"></i> Manage Announcements</h2>
        </div>
        <div class="nav-user">
            <span id="currentUser"></span>
            <button onclick="AdminAuth.logout()" class="logout-btn">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </nav>
    
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3>Admin Panel</h3>
            </div>
            <ul class="sidebar-menu">
                <li><a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li class="active"><a href="manage-announcements.html"><i class="fas fa-bullhorn"></i> Announcements</a></li>
                <li><a href="manage-news.html"><i class="fas fa-newspaper"></i> News</a></li>
                <li><a href="manage-vacancy.html"><i class="fas fa-briefcase"></i> Vacancies</a></li>
                <li><a href="manage-events.html"><i class="fas fa-calendar-alt"></i> Events</a></li>
                <li><a href="manage-press.html"><i class="fas fa-file-alt"></i> Press Releases</a></li>
            </ul>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <h1>Announcements Management</h1>
                <p>Add, edit, or delete announcements for the website</p>
                <button class="btn-primary" onclick="openAnnouncementForm()">
                    <i class="fas fa-plus"></i> Add New Announcement
                </button>
            </div>
            
            <!-- Announcement Form (Initially Hidden) -->
            <div id="announcementFormContainer" class="form-container" style="display: none;">
                <div class="form-header">
                    <h3><span id="formTitle">Add New</span> Announcement</h3>
                    <button class="btn-close" onclick="closeAnnouncementForm()">&times;</button>
                </div>
                <form id="announcementForm">
                    <input type="hidden" id="announcementId">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="announcementTitle"><i class="fas fa-heading"></i> Title *</label>
                            <input type="text" id="announcementTitle" required placeholder="Enter announcement title">
                        </div>
                        
                        <div class="form-group">
                            <label for="announcementCategory"><i class="fas fa-tag"></i> Category *</label>
                            <select id="announcementCategory" required>
                                <option value="">Select Category</option>
                                <option value="General">General</option>
                                <option value="Important">Important</option>
                                <option value="Urgent">Urgent</option>
                                <option value="Update">Update</option>
                                <option value="Notice">Notice</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="announcementDate"><i class="fas fa-calendar"></i> Date *</label>
                        <input type="text" id="announcementDate" required placeholder="Select date" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="announcementContent"><i class="fas fa-file-alt"></i> Content *</label>
                        <textarea id="announcementContent" rows="6" required placeholder="Enter announcement content"></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeAnnouncementForm()">Cancel</button>
                        <button type="submit" class="btn-primary" id="submitBtn">Add Announcement</button>
                    </div>
                </form>
            </div>
            
            <!-- Announcements List -->
            <div class="data-table-container">
                <h3>All Announcements</h3>
                <div class="table-actions">
                    <input type="text" id="searchInput" placeholder="Search announcements..." onkeyup="searchAnnouncements()">
                    <span id="totalCount" class="count-badge">0 announcements</span>
                </div>
                
                <div class="table-responsive">
                    <table id="announcementsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Category</th>
                                <th>Date</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="announcementsTableBody">
                            <!-- Data will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div id="noDataMessage" class="no-data">
                    <i class="fas fa-bullhorn"></i>
                    <p>No announcements found. Click "Add New Announcement" to create one.</p>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Delete</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this announcement? This action cannot be undone.</p>
                <p id="deleteItemTitle" class="delete-item-title"></p>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn-danger" onclick="confirmDelete()">Delete</button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="../js/storage.js"></script>
    <script src="../js/admin-auth.js"></script>
    <script src="../js/admin-crud.js"></script>
    <script>
        // Initialize date picker
        flatpickr("#announcementDate", {
            dateFormat: "Y-m-d",
            defaultDate: new Date()
        });
        
        // Display current user
        document.getElementById('currentUser').textContent = 
            'Welcome, ' + sessionStorage.getItem('hadiya_admin_user');
        
        // Load announcements on page load
        loadAnnouncements();
    </script>
</body>
</html>